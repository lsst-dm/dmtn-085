\subsection{Metrics Dashboard / SQuaSH}
\label{sec:comp:squash}

Derived from \S\ref{sec:design:test}.

\assign{Angelo}

To date, SQuaSH has been used to follow a subset of KPMs computed by validate\_drp for tracking performance regressions due to pipeline changes by regularly reprocessing test datasets in Jenkins/CI.

The following recommendations would enhance SQuaSH capabilities for DM developers.

\begin{recommendation}
    {rec:squash:use}
    {SQuaSH should be used by developers for tracking metrics on their particular projects}
\end{recommendation}

Developers can instrument their science pipeline Tasks using \texttt{lsst.verify} and create new verification packages to be tracked in SQuaSH (see e.g. \texttt{jointcal}). It would be interesting to send results to SQuaSH when testing development branches, so that developers can compare the new metric values with the previous values \textit{before} merging to master. Any metric defined in \texttt{lsst.verify.metrics} should be uploaded to SQuaSH including, for example, computational metrics like code execution time.

\begin{recommendation}
    {rec:squash:regression}
    {SQuaSH should provide automated notification of regressions}
\end{recommendation}

Metric specifications in \texttt{lsst.verify} include thresholds that can be used to automatically detect and notify regressions. The notifications could be presented to developers by Slack, for example.

\begin{recommendation}
    {rec:squash:summary}
    {SQuaSH should provide a metric summary display}
\end{recommendation}

Verification packages might have specialized visualizations for displaying metric summary information in addition to the current time series plot. DM developers should be able to extend SQuaSH by creating new visualizations following developer documentation provided in the SQuaSH Documentation (https://squash.lsst.io/)

\begin{recommendation}
    {rec:squash:ldf}
    {SQuaSH should support the LDF execution environment in addition to Jenkins/CI}
\end{recommendation}

Pipeline runs on larger datasets (e.g. HSC RC2 weekly reprocessing) require more computation than can be provided in the Jenkins/CI environment. SQuaSH should be flexible to support other environments like the LDF environment.

\begin{recommendation}
    {rec:squash:dataId}
    {SQuaSH should be able to store and display metric values per DataId}
For example, CCD, visit, patch, tract, filter.
\end{recommendation}

Pipeline runs on larger datasets (e.g. HSC RC2 weekly reprocessing) also require to store and display metric values per \texttt{DataIds} as opposed to the entire dataset (e.g. test datasets in Jenkins/CI). The ability to identify metric values per filter name or spatially by CCD in a visit or per patch in a tract, would enhance SQuaSH display and monitoring capabilities, turning SQuaSH or its successor into a richer metric dashboard (see also \S\ref{sec:design:drill}).
