\documentclass[DM,authoryear,toc,lsstdraft]{lsstdoc}
\usepackage[nonumberlist,nogroupskip,toc,numberedsection=autolabel]{glossaries}
\makeglossaries
\input{glossary}

\input meta.tex

\title{QA Strategy Working Group Report}

\author{%
Bellm, E.C.,
Chiang, H.-F.,
Fausti, A.,
Krughoff, K.S.,
MacArthur, L.A.,
Morton, T.D.,
Swinbank, J.D and
Roby, T.
}

\setDocRef{\lsstDocType-\lsstDocNum}
\date{\vcsDate}

\setDocAbstract{%
Abstract.
}

\setDocChangeRecord{%
  \addtohist{\vcsRevision}{\vcsDate}{Unreleased draft.}{Bellm et al.}
}

% For specific WG recommendations
\newenvironment{recommendation}[1][]
{
  \begin{admonition}{green!5!white}{green!75!black}{Recommendation}{#1}
}
{
  \end{admonition}
}

\begin{document}

% For specific WG recommendations
\newcommand{\assign}[1]{
  \begin{admonition}{red!5!white}{red!75!black}{Assignee}{}#1\end{admonition}
}

\maketitle

\section{Introduction}
\label{sec:intro}

\assign{John}

This report constitutes the primary artefact produced by the DM \gls{qawg},
addressing its charge as defined in \citeds{LDM-622}.

\section{Approach to the Problem}

\assign{John}

\subsection{Pipeline debugging}

\assign{John}

What tools do we need to help pipeline developers with their everyday work?

\begin{itemize}

  \item{How do you go about debugging a \texttt{Task} that is crashing?}
  \item{Is \texttt{lsstDebug} adequate?}
  \item{Do we need an afwFigure, for generating plots, to go alongside \texttt{afwDisplay}, for showing images?}
  \item{What additional capabilities are needed for developers running and debugging at scale, e.g. log collection, identification of failed jobs, etc.}
  \item{What's needed from an image viewer for pipeline developers? Is DS9 or Firefly adequate? Is there value to the afwDisplay abstraction layer, or does it simply make it harder for us to use Firefly's advanced features?}
  \item{How do we view images which don't fit in memory on a single node?}
  \item{How do we handle fake sources? Is this a provenance issue?}

\end{itemize}

\subsection{Drill down}

\assign{John}

\subsection{Datasets and test infrastructure}

\assign{John}

\section{Design sketch}

\subsection{Pipeline debugging}

\assign{John}

\subsection{Drill down}

\assign{Tim}

\subsection{Datasets and test infrastructure}

\assign{John}

\section{Core components}

\subsection{Updated pipeline debugging system}

\assign{Simon}

i.e. redesigned \texttt{lsstDebug}.

\subsection{Logging}

\assign{Simon}

\subsection{Capability for developers to run pipelines at scale}

\assign{Lauren}

\subsection{Guidance on visualization}

\assign{Lauren}

We're requesting a set of guidelines for developers here, not a new framework
--- but that's still a concrete deliverable (it's just documentation, rather
than code). We might suggest that these guidelines be developed by a new WG,
per Simon's
suggestion\footnote{\url{https://confluence.lsstcorp.org/display/DM/Pipeline+Debugging+Design}}.

\subsection{Image viewer}

\assign{Trey}

As of 2018-06-12 we haven't converged on a solid recommendation here.

Key considerations:

\begin{itemize}

  \item{Firefly is the annointed solution being provided by DM to external
  stakeholders (commissioning, operations, etc). It feels right to everybody
  that we should be dogfooding it, and also benefitting from development being
  carried out for those stakeholders.}

  \item{Currently, Firefly is unappealing to developers (primarily, I think,
  because of slowness of user interface, and perhaps also due to installation
  issues). Can we resolve these issues?}

  \item{We'd want to support visualization in a number of different
  environments, for e.g.:

    \begin{itemize}

      \item{Inside a Jupyter notebook;}
      \item{As a standalone tool, \`a la DS9;}
      \item{Embedded in a \gls{dashboard}, \`a la JS9, Aladin-Lite, etc.}

    \end{itemize}
  }

  \item{Do we lose flexibility by mandating the use of a backend-agnostic API
  (\texttt{afwDisplay}) rather than going ``all-in'' on e.g. a custom Firefly
  interface?}

  \item{We'll need to do full focal plane visualization, which none(?) of the
  current tools support well.}

\end{itemize}

Options include:

\begin{itemize}

  \item{Do nothing; continue as we are, which means most people will use DS9
  and a few will drift to Firefly as commissioning ramps up.}

  \item{Issue some sort of edict that pipelines developers have to use
  Firefly.}

  \item{Encourage the use of some other tool (Ginga?) instead of or as well as
  some of the above.}

  \item{Probably others.}

\end{itemize}

Sounds like we need somebody from the QAWG to actually write some requirements
--- or a wishlist set of features we want --- here.

\subsection{Catalog visualization tools}

\assign{Lauren}

For visualizing bigger-than-memory catalogs. May include e.g. the capability
to spin up Dask clusters on demand, combined with
Holoviews/Datashader/whatever. Somebody who knows about this stuff needs to
write a summary...

\subsection{Provenance}

\assign{Hsin-Fang}

This section should note:

\begin{itemize}

  \item{That provenance is an immediate issue impacting QA work, so a solution
  is a priority;}

  \item{Some requirements as to the granularity at which provenance tracking
  is necessary for QA.}

\end{itemize}

\appendix
\glsaddall
\printglossary[style=index]

\bibliography{lsst,lsst-dm,refs_ads,refs,books}

\end{document}
